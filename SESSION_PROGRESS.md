# ‚úÖ –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —Å–µ—Å—Å–∏–π - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

## –ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ

### 1. –ù–æ–≤—ã–µ –ø–æ–ª—è –≤ User

```python
current_session_total: Optional[int] = None  # –í—Å–µ–≥–æ –∫–∞—Ä—Ç–æ—á–µ–∫ –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏
current_session_index: int = 0               # –¢–µ–∫—É—â–∏–π –∏–Ω–¥–µ–∫—Å –≤ —Å–µ—Å—Å–∏–∏
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- `current_session_total` - —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ —Å–µ—Å—Å–∏–∏, –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è
- `current_session_index` - —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∫–∞—Ä—Ç–æ—á–∫–µ

---

## 2. –õ–æ–≥–∏–∫–∞ —Ñ–∞–∑—ã –æ–±—É—á–µ–Ω–∏—è (Learning)

**–ü—Ä–æ–≥—Ä–µ—Å—Å:**
```
–ö–∞—Ä—Ç–æ—á–∫–∞ 1/21
–ö–∞—Ä—Ç–æ—á–∫–∞ 2/21
...
–ö–∞—Ä—Ç–æ—á–∫–∞ 21/21
```

**–ö–∞–∫ —Å—á–∏—Ç–∞–µ—Ç—Å—è:**
- `completed` = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∂–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
- `total` = –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç–æ—á–µ–∫ (21)
- –ü–æ–∫–∞–∑: `(completed + 1)/total`

**–ù–µ –Ω—É–∂–Ω–æ session tracking** - –ø—Ä–æ—Å—Ç–æ –ø–æ –ø–æ—Ä—è–¥–∫—É!

---

## 3. –õ–æ–≥–∏–∫–∞ —Ñ–∞–∑—ã –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è (Review)

### –ù–∞—á–∞–ª–æ —Å–µ—Å—Å–∏–∏ (–∫–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ"):

```python
due_cards = await get_cards_for_review()  # –ù–∞–ø—Ä–∏–º–µ—Ä, 16 –∫–∞—Ä—Ç–æ—á–µ–∫

# –§–∏–∫—Å–∏—Ä—É–µ–º –≤ –Ω–∞—á–∞–ª–µ!
user.current_session_total = len(due_cards)  # 16
user.current_session_index = 1               # –ü–µ—Ä–≤–∞—è
```

**–ü–æ–∫–∞–∑:**
```
üìä –ü—Ä–æ–≥—Ä–µ—Å—Å: 1/16

üá∑üá∫ –¢–µ–∫—Å—Ç...
```

### –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–π –∫–∞—Ä—Ç–æ—á–∫–µ:

```python
# –ü–æ—Å–ª–µ –æ—Ü–µ–Ω–∫–∏
user.current_session_index += 1  # 2, 3, 4, ...
# total –ù–ï –º–µ–Ω—è–µ—Ç—Å—è! –û—Å—Ç–∞–µ—Ç—Å—è 16
```

**–ü–æ–∫–∞–∑:**
```
üìä –ü—Ä–æ–≥—Ä–µ—Å—Å: 2/16
üìä –ü—Ä–æ–≥—Ä–µ—Å—Å: 3/16
...
üìä –ü—Ä–æ–≥—Ä–µ—Å—Å: 16/16
```

### –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏:

```python
# –ü–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–∞—Ä—Ç–æ—á–∫–∏
user.current_session_total = None
user.current_session_index = 0
```

**–ü–æ–∫–∞–∑:**
```
‚úÖ –û—Ç–ª–∏—á–Ω–æ! –í—ã –ø–æ–≤—Ç–æ—Ä–∏–ª–∏ –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è.
```

---

## 4. –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã

### –î–µ–Ω—å 1 - –û–±—É—á–µ–Ω–∏–µ:

```
/start
‚Üí –ü—Ä–æ–≥—Ä–µ—Å—Å: 1/21
‚Üí –ü—Ä–æ–≥—Ä–µ—Å—Å: 2/21
...
‚Üí –ü—Ä–æ–≥—Ä–µ—Å—Å: 21/21
‚Üí "–û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!"
```

### –î–µ–Ω—å 2 - –ü–µ—Ä–≤–æ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ (16 –∫–∞—Ä—Ç–æ—á–µ–∫ –≥–æ—Ç–æ–≤—ã):

```
–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "16 –∫–∞—Ä—Ç–æ—á–µ–∫ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è"
[–ù–∞—á–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ] ‚Üê –ù–∞–∂–∞—Ç—å

‚Üí current_session_total = 16 (—Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è!)
‚Üí current_session_index = 1

–ö–∞—Ä—Ç–æ—á–∫–∞ 1: –ü—Ä–æ–≥—Ä–µ—Å—Å: 1/16
–ö–∞—Ä—Ç–æ—á–∫–∞ 2: –ü—Ä–æ–≥—Ä–µ—Å—Å: 2/16
...
–ö–∞—Ä—Ç–æ—á–∫–∞ 16: –ü—Ä–æ–≥—Ä–µ—Å—Å: 16/16
‚Üí "–û—Ç–ª–∏—á–Ω–æ! –í—Å–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–æ"
```

### –î–µ–Ω—å 3 - –í—Ç–æ—Ä–æ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ (8 –∫–∞—Ä—Ç–æ—á–µ–∫ –≥–æ—Ç–æ–≤—ã):

```
–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "8 –∫–∞—Ä—Ç–æ—á–µ–∫ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è"
[–ù–∞—á–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ] ‚Üê –ù–∞–∂–∞—Ç—å

‚Üí current_session_total = 8 (–Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ!)
‚Üí current_session_index = 1

–ö–∞—Ä—Ç–æ—á–∫–∞ 1: –ü—Ä–æ–≥—Ä–µ—Å—Å: 1/8
–ö–∞—Ä—Ç–æ—á–∫–∞ 2: –ü—Ä–æ–≥—Ä–µ—Å—Å: 2/8
...
–ö–∞—Ä—Ç–æ—á–∫–∞ 8: –ü—Ä–æ–≥—Ä–µ—Å—Å: 8/8
```

**–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç:** Total —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ –∏ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–µ—Å—Å–∏–∏!

---

## 5. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### handlers/start.py - callback "start_review":

```python
@router.callback_query(F.data == "start_review")
async def start_review(callback: CallbackQuery):
    due_cards = await card_manager.get_cards_for_review(...)
    
    # –§–ò–ö–°–ò–†–£–ï–ú –≤ –Ω–∞—á–∞–ª–µ —Å–µ—Å—Å–∏–∏
    user.current_session_total = len(due_cards)  # 16
    user.current_session_index = 1
    
    await callback.message.edit_text(f"–ü—Ä–æ–≥—Ä–µ—Å—Å: 1/{len(due_cards)}")
```

### handlers/review.py - show_next_card:

```python
async def show_next_card(...):
    # –£–í–ï–õ–ò–ß–ò–í–ê–ï–ú –∏–Ω–¥–µ–∫—Å
    user.current_session_index += 1
    
    # Total –ù–ï –º–µ–Ω—è–µ—Ç—Å—è!
    await callback.message.edit_text(
        f"–ü—Ä–æ–≥—Ä–µ—Å—Å: {user.current_session_index}/{user.current_session_total}"
    )
```

---

## 6. –û–±—Ä–∞–±–æ—Ç–∫–∞ edge cases

### –ï—Å–ª–∏ session –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞:
```python
if user.current_session_total:
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    progress = f"{user.current_session_index}/{user.current_session_total}"
else:
    # Fallback
    progress = f"1/{len(due_cards)}"
```

### –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Å–µ—Å—Å–∏–∏:
```python
user.current_session_total = None
user.current_session_index = 0
```

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
1. `storage/models.py` - –¥–æ–±–∞–≤–ª–µ–Ω—ã session –ø–æ–ª—è
2. `handlers/start.py` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Å—Å–∏–∏
3. `handlers/review.py` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞, —Å–±—Ä–æ—Å –≤ –∫–æ–Ω—Ü–µ

**–ë–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω!**

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –û–±—É—á–µ–Ω–∏–µ
```
/start
‚Üí –ü—Ä–æ–≥—Ä–µ—Å—Å: 1/21
‚Üí –ü—Ä–æ–≥—Ä–µ—Å—Å: 2/21
...
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ (–ø–æ—Å–ª–µ —á–∞—Å–∞)
```
–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "X –∫–∞—Ä—Ç–æ—á–µ–∫"
[–ù–∞—á–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ]
‚Üí –ü—Ä–æ–≥—Ä–µ—Å—Å: 1/X  ‚Üê –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ!
‚Üí –ü—Ä–æ–≥—Ä–µ—Å—Å: 2/X
...
‚Üí –ü—Ä–æ–≥—Ä–µ—Å—Å: X/X
```

**Total –ù–ï –º–µ–Ω—è–µ—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ!** ‚úÖ

---

**–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ!** üöÄ

